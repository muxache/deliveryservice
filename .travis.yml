dist: trusty
jdk: oraclejdk8
language: java
services:
- postgresql
- docker
env:
  global:
  - secure: BzH1mnv2YGLDDTMA+pMQL3PYJFu9noLx2NnEGvhaQdUjwfWyGw6CNmk12JKakM0sLdxZZL04NXtY0C7mUerGTBkmzKF4K62gFFbc4h90xDrm1lRpeh/P+xquSIdpHxYPkkJpyFmFsrN4onISJCICM6xj1w/5HsgHZ3qtnSIbbSfYKZvo18mCWidMqy1nJzO+89WE3rLWopuePYc1ICaD7Bp6kLwSrwlU4ZhQF/VQy7iHY7LJuq2UosQ3QO3fLRu9QFXaF9Z8IQU/SEOyU8rFXb1CTGOfNsZ3jxfnb0AgbkagM5E2hQc0CLgoBMHiVM/zz8sG5ijDwhMQ2yYV29qOxf5E7JIVgmsxQk1J27QDIBUGB8aAAPHHUzIS/12qD9jlM0H/Cx3xO3CnV1HJ1rDsElkpkiZg1z4kuhtIG0vR2d8HdB3Ij9RX1LydWPISWALVGNOUUDolCtrvOnO/ZPqhzOMzSMiC2xzyq2IJkXHFU1COMtAmF6fsiFFpEV5MX3zXcujDy9Ea8NtwbdK0z2Pu9KcR9SnV4873NYZH1JeqJWbjcVCRgl0cK/V7IrDebB/6P9WZyZhgcixacAYPwYfQIlyo4+vUmKwbw6etmYcJSgf9Y2tHw+VsTh82d+6EJcYimo9Wg/6nUVXR8p8Kqw30lZAlh25bI7pLSX3X83fQ4o8=
  - secure: bJNresYuu+nigKke8sEwQLMu7sct3kwfIMOSmnkv/tLS2BlpT3piMm+15rW3tgt+AwkKZkT9xsmXpYMTChCgQ4g8y6DlqK9ebySLvZvtX5w81aMIrNxMmPul20pjbNVUbop6njuPkdSlweIxzI9SVYGeuyTGKZ6hlTbL998gp4aAaUhgimQhXsNjGL11QySH7SvrhTU4aQWg2bqV00GL0r1rppkgrMO3+zKrZ6hlhGXJLnVAH2uJjY4M7z1LgHVtgl9BwdgN4XxMSiCGbxicFXMDgLnfF/43yRzpBmAnZlbLZCvNNvfko7jzVIRPFBXhSF4kHvWOteQkFV57HT6RraxpuLVqCfuS8bD/nxly1gd6lVwpGnbsZ/KR0egVf1Dkdl0aS3w1V1gfhDtUObKcsfLngdEvRy11IYg2xGFt4bib6OXGABKZSwC0c7iAhH06/YI7XGf1OgifXpDnk/O7lMg4+LyBMt2WFDwE6Fr8epc6QKeFuQerXc/YYmfc6nZXEf2wCSKkd0CRWI4G2QO38jB/tVxBSJyzMJK7R6JKw14J98Mcg5djQVMKOdb9/qNJimc4Xh+SYLbJgmIwfdqLR/QNJdvHBSsafrmW0cur44S+YMbFFH3BfbdmpXryU66TWX+3bMgDAhepKHbuZ6W82QVste3vvUa8lnYRwJWyqyc=
  - secure: d6tQIz9+xXWT6d98oL2ip3H34EWTMXuFQbhxWv8eQaIWkd/y9yYSEBhdVJLUpTSgMYZMq7M/IE7WiE4j0GuGaW+Hfkjto9zqPgHRqghmJe5J5ocxegsW2ym+VYeDvEuz+FikB8MR7BxTIBcrCMa6tUWvPIIpy47kkacYuMGeheyBzkdzDbjb2N7jl40Ur/3qFAdi47EB1DTDVXIJ2SRGX3dofwLh3QARdBa7fKOZ5W3P2KZufRocUZHDelJDZ+K2JpXQNDz/4AeK8DWryMeBwLpHWSEdXYweoHDuMrF9fuS5Mo/i+VyHPWfh4yPkhciIyWBxVhwjRJAW0Nyn2AW0HjjDlKsHR74oE9oNs4rNWIB0Z/DlI0R6NsinIakdPVyYVusnVmUkn7Ykl5Xfq61zY8JOI1D0+eUo8olKT7FvnIuhlZKPfMz41D7fpDpTaM+PfhhaV9SlAXFfmud21kttvorfLZwQQ1JtgVaSmEmEKxBktYWJ9xBS9odRnv18SNc5PUkEus5evKexMsJmHcSRxUmU/sp81NMkCSkE3oOwp3Eoyy5OzB9tbC7bPaJrQOW+ZxWAS5zf3d2s6C0QVRd5WNA/6OEBjDBj9s85IXIiy8tQtJIl2PDhEXKminqIXnnlGjdBff++OT8F90VHxvPyM16OQAY6ijawIUyfKnYN13o=
  - COMMIT=${TRAVIS_COMMIT::7}
  - secure: QnUWi3QtjxwcEjzRhZAdGLHAuGdaBdR4/oz7bDBvHkSADyA8siob6rj+3SSAKbPXaDs6A+IwUu2gfvwluUvdxH38Fuq+zz/0e2/pPG/U33LyIBkz6HssEbalNqs7xIfO7iF0fI9O5SGlXxtUgqOHHvT4u81/pdAkOLKcYOCvKeFyuDQRX77JQYleMereA9qzueuqTrYb24UdiWo6DG0TQ98AiMNuOr/eR5zpEFB6u6GjkRmgM7psJEsEUaBPF8lChmnUvw0igkChVgaM4HBmTgu6du1IZ3x1idzdTNq8vra+PaIXOKec6UrI7ErWC8hG8dWzKAy+t8RCrOpRggnq5xHKOgucXfP5cjCYqmmn6WVlMCdGfgz8kXInya7ZeyXw7+3baMUdgxQ7E9ENc9XoWIiqhnI7hYmQqye/8ZD1QByWiV82Reo9zc1zB1auYGRjoVJPzpu6Qafksol1ZHUKLk3zIvgGXTfoeME51VYr7S7uVhD94bUPaNDEY3tGEO3oeqIX99ojUz+8y/N0YnXBiZkMwMCPC17k55U2Ac63t6hqFlJtWl0oTTyPrFpfOY9UcbcmLN0vXHUy0Htx0hoggTxtXOfvWnsqrLzj+wG8YjY8m8+w3emwlOPD2nJdPoUB35G3uuUKANjmHqvQX67vhuOCFaDgcQXb29TyYaLSlMk=
  - secure: e3ldzozL26WKAjF8L6SgEiqWbxHSp7BZGsX7oFSYS/4HPO0Ng/PJ6pCAop27owUQST5jYkMQRA6xzmNLRwo2Mref8YXy/kSYeZRp/o1WLVNEyA8o4YJlfvKSoqr0o1XCnKDU0lwYVkcaEjfev7jpw/YICLN/oK9a1NRmu2fkunE5OaxmA/sLGDkYuXeNKuB0MfiP+9U77YXm8q1GjBG7EIao45aqF/koKFOal5HNyu1j2Z3Oc8sFlTO4wnyTivPoQzI9TNer0KynoKBEI/N9X12WmmkWVp9Gm+lhfafXBPtMnHjnOQLaeRk3Dns8deMOrCUd/3zXCeX9DArKPe1Ovi4XbkqhMca5VP5FJwhtpRHwgur8i/HrFuHfdEpktmVgD2VUP5l6tcsW7V3Y+kJFlyTKJaCsqR2svDGBX2QmN9hETaBC01q+b0f0RwxUvn0sI4IQQLYzBcogsKE6I32U2YtwRsMjaylc10NE9aDmgLhpfu7nYBiBYglcV745s0t1EwGYa6g2QCFPWqnhEZG3RffJ4wTNZ8XaL4A/E698PkT0BrA46ausODDHwYyrQUL3MSvYAx5axgloueq/g46b+rglivfi+27s6HTslbuMqA5Xp56BNVSrqWdlmxBu1B6YnUUyA2b33OveTdn5o80n/rUYKk5h3Qs9olEzw0L+/W8=
  - secure: LN8PJ+jir8UiKl+A0b4MlVrw2Yq3HDJtp3h0TIZPVV6NDDDQ9vFR562bomoZ6JDyrRARaIKiUmzbu+ikR2bMphMyAHcPEy4uNIHe7Gq2JaPW4ScTUw2c6hxQVaG7EoymXQTPJ22LN3SbyHr8JWSJXixCfUrjk9rbu/XPo3O9zOt8PvE9zvNiWJQ4VTqsl9XZOfszMuG2COUR6UxDecD3wUc0Xts7s8cpIupE+5vEvU0OZTdzUSCPqFXN16vL3VxjuLeUtP5ckW6jCOlZUjqbrS/0vEfTVEDK/RQDjAuqrwUcLIUaem3hY0agkpZEmLy6fMs4XH0F1k1kbgO1wkjGKH/V+bm7E5EILgVhccahonHKjA6YZ+j3KjaCV3AbbDhdOg0u2cBkQp2R4C+LGo6JOY/ASOOwtUD/GHDcDShqVf11ZuifOnvFEgiqDmVLnyJwlkC0hSZiGSgKsT6FHuRJZEvDeTfAdmaCuV1nIgP9TKalgDR62nbZXARCOgAtvGj6OkvzAbsWXihLCbmu25pKDgujIbytCFYVaRpOts1d+eP+O7MNafK6NJqqs1acsECB8K5LjSpP3y3LKbk1WapGy08Z/e0VWogDc2tYVR05QaAnHWRwtFYkHfv1IdEaWM26YhMXNHkTe4EGaGoiZPFOXmUdqkq9XUhRyODySAAHdOY=
script:
- "./mvnw clean install -B"
after_success:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo "$TRAVIS_BRANCH";
  fi`
- export IMAGE_NAME=$DOCKER_USER/deliveryservice-docker-image
- docker build -t $IMAGE_NAME:latest .
- docker tag $IMAGE_NAME:latest $IMAGE_NAME:$TAG
- docker push $IMAGE_NAME:$TAG
deploy:
  provider: heroku
  api_key: "$HEROKU_API_KEY"
  app: deliveryservice1
